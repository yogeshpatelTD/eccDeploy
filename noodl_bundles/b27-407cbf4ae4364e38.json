[{"name":"/#view/Chain of Custody View","nodes":[{"id":"0c603aca-822b-0b02-384a-c81490efece0","type":"Page","parameters":{},"ports":[],"children":[{"id":"e19fbc8f-b575-142d-5ab1-fd4c8c7383f3","type":"Group","parameters":{"backgroundColor":"#FFFFFF","flexDirection":"row"},"ports":[],"children":[{"id":"263dbb78-b86c-e132-3186-0df942f105ca","type":"/#component/Sidebar","parameters":{},"ports":[],"children":[]},{"id":"c1e9ee46-196a-9b38-0b4b-56f55d2320f9","type":"Group","parameters":{"sizeMode":"explicit"},"ports":[],"children":[{"id":"537058f6-4c5f-cd4d-a224-59ffc36ab8d7","type":"Group","parameters":{"sizeMode":"explicit","height":{"value":60,"unit":"px"}},"ports":[],"children":[{"id":"f1560df5-95f0-a744-ce76-854af6af7e54","type":"/#component/navbar","parameters":{"pagename":"Chain of Custody List"},"ports":[],"children":[]}]},{"id":"36c92656-97e1-3c69-8157-b318743e6a61","type":"Group","parameters":{"paddingLeft":{"value":15,"unit":"px"},"paddingRight":{"value":15,"unit":"px"},"scrollEnabled":false},"ports":[],"children":[{"id":"ab68c51e-dda5-37f6-2d1a-86797e300e43","type":"/#component/Table","parameters":{"Items":"[\n    {\n        \"Project No.\": \"ASB-003\",\n        \"Sample Id\": \"SAM-527\",\n        \"Type\": \"Wall Plaster\",\n        \"Location\": \"Cellar-Columns\",\n        \"Edit\": \"Go\",\n    },\n    {\n        \"Project No.\": \"ASB-461\",\n        \"Sample Id\": \"SAM-452\",\n        \"Type\": \"Ceiling tile (2'x2')\",\n        \"Location\": \"Ceiling in Basement\",\n        \"Edit\": \"Go\",\n    },\n    {\n        \"Project No.\": \"ASB-009\",\n        \"Sample Id\": \"SAM-035\",\n        \"Type\": \"Wall Plaster\",\n        \"Location\": \"2nd Floor\",\n        \"Edit\": \"Go\",\n    },\n    {\n        \"Project No.\": \"ASB-983\",\n        \"Sample Id\": \"SAM-761\",\n        \"Type\": \"Floor tile\",\n        \"Location\": \"1st Floor-Storage Areas\",\n        \"Edit\": \"Go\",\n    }    \n    \n    \n]","Margin Top":{"value":20,"unit":"px"},"Headers":"[\r\n  {\r\n    Field: 'Project No.',\r\n    Label: 'Project No.',\r\n  },\r\n  {\r\n    Field: 'Sample Id',\r\n    Label: 'Sample Id',\r\n  },\r\n  {\r\n    Field: 'Type',\r\n    Label: 'Type',\r\n  },\r\n  {\r\n    Field: 'Location',\r\n    Label: 'Location',\r\n  },\r\n  {\r\n    Field: 'Action',\r\n    Label: 'Action',\r\n    Type: 'Button coc',\r\n  },\r\n]","Margin Bottom":{"value":10,"unit":"px"}},"ports":[],"children":[]}]},{"id":"29106c83-a2c5-4883-11a2-b3cba05c8320","type":"Group","parameters":{"height":{"value":80,"unit":"vh","isFixed":false},"scrollEnabled":true,"paddingLeft":{"value":5,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingRight":{"value":5,"unit":"px"},"paddingBottom":{"value":80,"unit":"px"},"sizeMode":"explicit","rowGap":{"value":10,"unit":"px"},"marginTop":{"value":10,"unit":"px"},"marginBottom":{"value":0,"unit":"px"}},"ports":[],"children":[{"id":"c255f409-16e5-6567-118d-84860f85f188","type":"For Each","parameters":{"templateType":"explicit","template":"/#view/Chain of Custody View/coc Card View"},"ports":[],"children":[]}]},{"id":"26d501d2-a7e4-8556-c991-1f754f1545fe","type":"Group","parameters":{"sizeMode":"contentHeight","position":"sticky","alignY":"bottom","backgroundColor":"#FFFFFF00"},"ports":[],"children":[{"id":"f1273349-fa3c-ca76-3df0-9855ef55ace9","type":"/#component/limit & offset","parameters":{},"ports":[],"children":[]}]}]}]}]},{"id":"ff291fb8-656e-2021-1fa4-299d59f84649","type":"PageInputs","parameters":{},"ports":[],"children":[]},{"id":"fb9b1ddd-9c3c-d2d7-a2a0-41caf5303b81","type":"JavaScriptFunction","parameters":{"functionScript":"const width = Inputs.width\r\nif (width > 800){\r\n    Outputs.header = [\r\n  {\r\n    Field: 'project_number_text',\r\n    Label: 'Project No.',\r\n    // Type: 'ins'\r\n  },\r\n  // {\r\n  //   Field: 'id_text',\r\n  //   Label: 'Project No.',\r\n  //   Type: 'ins'\r\n  // },\r\n  {\r\n    Field: 'client_name_text',\r\n    Label: 'Client',\r\n  },\r\n  {\r\n    Field: 'client_contact_text',\r\n    Label: 'Contact',\r\n  },\r\n  {\r\n    Field: 'client_phone_text',\r\n    Label: 'Phone',\r\n  },\r\n  {\r\n    Field: 'address',\r\n    Label: 'Address',\r\n  },\r\n  {\r\n    Field: 'id_sa',\r\n    Label: 'Total Sample',\r\n    Type: 'total sample',\r\n  },\r\n  {\r\n    Field: 'id_action',\r\n    Label: 'Action',\r\n    Type: 'Button coc',\r\n  },\r\n]\r\n\r\n\r\n}\r\nelse {\r\n    Outputs.header = [\r\n  {\r\n    Field: 'project_number_text',\r\n    Label: 'Project No.',\r\n    // Type: 'ins'\r\n  },\r\n  // {\r\n  //   Field: 'id_text',\r\n  //   Label: 'Project No.',\r\n  //   Type: 'ins'\r\n  // },\r\n  {\r\n    Field: 'client_name_text',\r\n    Label: 'Client',\r\n  },\r\n  {\r\n    Field: 'id_action',\r\n    Label: 'Action',\r\n    Type: 'Button coc mobile',\r\n  },\r\n]\r\n\r\n\r\n}","scriptInputs":[{"id":"42or","label":"width"}],"intype-width":"number","scriptOutputs":[{"id":"3ii6","label":"header"}],"outtype-header":"array"},"ports":[{"name":"outtype-header","displayName":"Type","editorName":"header | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"3ii6","index":4},{"name":"out-header","displayName":"header","plug":"output","type":"array","group":"Outputs","index":5},{"name":"intype-width","displayName":"Type","editorName":"width | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"42or","index":6},{"name":"in-width","displayName":"width","plug":"input","type":"number","group":"Inputs","index":7}],"children":[]},{"id":"edc54347-16b3-fca9-35be-7e90f3e796ca","type":"JavaScriptFunction","parameters":{"functionScript":"if(!Inputs.Triggered) return;\r\nconst supabase = Noodl.Variables.supabase;\r\n\r\nif (!supabase) throw new Error('Supabase client not found');\r\nconst company = Inputs.Company\r\nconst limit = parseInt(Inputs.Limit);\r\nconst offset = Inputs.Offset\r\n\r\ntry {\r\n  const { data, error } = await supabase\r\n                          .rpc('coc_view', {\r\n                            company_input: company,\r\n                            limit_input: limit,\r\n                            offset_input: offset\r\n                            });\r\n\r\n  if (error) {\r\n    console.error(error)\r\n    Outputs.Failure();\r\n  } else {\r\n    \r\n    console.log(\"mapped DATA ==========\")\r\n    Outputs.Inspection = data\r\n    console.log(data)\r\n    Outputs.Success();\r\n  }\r\n} catch (error) {\r\n    console.error(error)\r\n  Outputs.Failure();\r\n}\r\n  ///if is closed\r\n\r\n"},"ports":[{"name":"in-Triggered","displayName":"Triggered","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-Company","displayName":"Company","plug":"input","type":"*","group":"Inputs","index":5},{"name":"in-Limit","displayName":"Limit","plug":"input","type":"*","group":"Inputs","index":6},{"name":"in-Offset","displayName":"Offset","plug":"input","type":"*","group":"Inputs","index":7},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":8},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":9},{"name":"out-Inspection","displayName":"Inspection","plug":"output","type":"*","group":"Outputs","index":10}],"children":[]},{"id":"20855604-cc84-21a5-8c69-88d31d42fd24","type":"Model2","parameters":{"modelId":"currentUser","properties":"company,email,role,name"},"ports":[],"children":[]},{"id":"bc570b3c-06f3-1787-7d60-73dd1362cd97","type":"States","parameters":{"type-show":"boolean","states":"tab,mob","values":"table,repeater","type-table":"boolean","type-repeater":"boolean","value-tab-table":true,"value-mob-repeater":true},"ports":[],"children":[]},{"id":"98ba3b90-0e76-a2b5-c0ea-cce649b7c827","type":"JavaScriptFunction","parameters":{"functionScript":"const width = Inputs.Width\r\nif(width < 429){\r\n    Outputs.Mob();\r\n}\r\nelse{\r\n    Outputs.Tab();\r\n}"},"ports":[{"name":"in-Width","displayName":"Width","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Mob","displayName":"Mob","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Tab","displayName":"Tab","plug":"output","type":"signal","group":"Outputs","index":6}],"children":[]},{"id":"a309b344-64f1-650e-a834-6bf645c01071","type":"/#component/loading","parameters":{},"ports":[],"children":[]},{"id":"fd5f3025-4b1c-0e5a-e6bb-1142233b5f76","type":"Set Variable","parameters":{"name":"currentPage","setWith":"string","value":"coc"},"ports":[],"children":[]},{"id":"a7cae4e4-3d3f-1444-12ee-8157ce3d7eac","type":"JavaScriptFunction","parameters":{"functionScript":"const supabase = Noodl.Variables.supabase;\r\n\r\nif (!supabase) throw new Error('Supabase client not found');\r\nconst company = Inputs.Company\r\n\r\ntry {\r\nconst { data, error } = await supabase\r\n                        .from('inspection_request')\r\n                        .select('count', { count: 'exact' })\r\n                        .eq(\"company_id\",company);\r\n\r\nif (error) {\r\n    console.error(error)\r\n    Outputs.Failure();\r\n} else {\r\n    const count = data ? data[0].count : 0;\r\n    Outputs.Count = count\r\n    Outputs.Success();\r\n}\r\n} catch (error) {\r\n    console.error(error)\r\nOutputs.Failure();\r\n}"},"ports":[{"name":"in-Company","displayName":"Company","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Count","displayName":"Count","plug":"output","type":"*","group":"Outputs","index":7}],"children":[]},{"id":"5a0970a4-1324-263c-31ad-d676ab746dee","type":"Timer","parameters":{"duration":50},"ports":[],"children":[]}],"connections":[{"sourceId":"0c603aca-822b-0b02-384a-c81490efece0","sourcePort":"boundingWidth","targetId":"263dbb78-b86c-e132-3186-0df942f105ca","targetPort":"width"},{"sourceId":"fb9b1ddd-9c3c-d2d7-a2a0-41caf5303b81","sourcePort":"out-header","targetId":"ab68c51e-dda5-37f6-2d1a-86797e300e43","targetPort":"Headers"},{"sourceId":"0c603aca-822b-0b02-384a-c81490efece0","sourcePort":"boundingWidth","targetId":"fb9b1ddd-9c3c-d2d7-a2a0-41caf5303b81","targetPort":"in-width"},{"sourceId":"0c603aca-822b-0b02-384a-c81490efece0","sourcePort":"boundingWidth","targetId":"f1560df5-95f0-a744-ce76-854af6af7e54","targetPort":"width"},{"sourceId":"20855604-cc84-21a5-8c69-88d31d42fd24","sourcePort":"prop-company","targetId":"edc54347-16b3-fca9-35be-7e90f3e796ca","targetPort":"in-Company"},{"sourceId":"20855604-cc84-21a5-8c69-88d31d42fd24","sourcePort":"prop-company","targetId":"edc54347-16b3-fca9-35be-7e90f3e796ca","targetPort":"in-Triggered"},{"sourceId":"edc54347-16b3-fca9-35be-7e90f3e796ca","sourcePort":"out-Inspection","targetId":"ab68c51e-dda5-37f6-2d1a-86797e300e43","targetPort":"Items"},{"sourceId":"98ba3b90-0e76-a2b5-c0ea-cce649b7c827","sourcePort":"out-Mob","targetId":"bc570b3c-06f3-1787-7d60-73dd1362cd97","targetPort":"to-mob"},{"sourceId":"98ba3b90-0e76-a2b5-c0ea-cce649b7c827","sourcePort":"out-Tab","targetId":"bc570b3c-06f3-1787-7d60-73dd1362cd97","targetPort":"to-tab"},{"sourceId":"0c603aca-822b-0b02-384a-c81490efece0","sourcePort":"boundingWidth","targetId":"98ba3b90-0e76-a2b5-c0ea-cce649b7c827","targetPort":"in-Width"},{"sourceId":"bc570b3c-06f3-1787-7d60-73dd1362cd97","sourcePort":"table","targetId":"36c92656-97e1-3c69-8157-b318743e6a61","targetPort":"mounted"},{"sourceId":"bc570b3c-06f3-1787-7d60-73dd1362cd97","sourcePort":"repeater","targetId":"29106c83-a2c5-4883-11a2-b3cba05c8320","targetPort":"mounted"},{"sourceId":"edc54347-16b3-fca9-35be-7e90f3e796ca","sourcePort":"out-Inspection","targetId":"c255f409-16e5-6567-118d-84860f85f188","targetPort":"items"},{"sourceId":"20855604-cc84-21a5-8c69-88d31d42fd24","sourcePort":"prop-company","targetId":"a309b344-64f1-650e-a834-6bf645c01071","targetPort":"show"},{"sourceId":"edc54347-16b3-fca9-35be-7e90f3e796ca","sourcePort":"out-Success","targetId":"a309b344-64f1-650e-a834-6bf645c01071","targetPort":"close"},{"sourceId":"0c603aca-822b-0b02-384a-c81490efece0","sourcePort":"didMount","targetId":"263dbb78-b86c-e132-3186-0df942f105ca","targetPort":"coc"},{"sourceId":"0c603aca-822b-0b02-384a-c81490efece0","sourcePort":"didMount","targetId":"fd5f3025-4b1c-0e5a-e6bb-1142233b5f76","targetPort":"do"},{"sourceId":"0c603aca-822b-0b02-384a-c81490efece0","sourcePort":"boundingWidth","targetId":"f1273349-fa3c-ca76-3df0-9855ef55ace9","targetPort":"width"},{"sourceId":"20855604-cc84-21a5-8c69-88d31d42fd24","sourcePort":"prop-company","targetId":"a7cae4e4-3d3f-1444-12ee-8157ce3d7eac","targetPort":"in-Company"},{"sourceId":"a7cae4e4-3d3f-1444-12ee-8157ce3d7eac","sourcePort":"out-Count","targetId":"f1273349-fa3c-ca76-3df0-9855ef55ace9","targetPort":"Total count"},{"sourceId":"f1273349-fa3c-ca76-3df0-9855ef55ace9","sourcePort":"skip","targetId":"edc54347-16b3-fca9-35be-7e90f3e796ca","targetPort":"in-Offset"},{"sourceId":"f1273349-fa3c-ca76-3df0-9855ef55ace9","sourcePort":"limit","targetId":"edc54347-16b3-fca9-35be-7e90f3e796ca","targetPort":"in-Limit"},{"sourceId":"f1273349-fa3c-ca76-3df0-9855ef55ace9","sourcePort":"changed","targetId":"5a0970a4-1324-263c-31ad-d676ab746dee","targetPort":"start"},{"sourceId":"5a0970a4-1324-263c-31ad-d676ab746dee","sourcePort":"timerFinished","targetId":"edc54347-16b3-fca9-35be-7e90f3e796ca","targetPort":"in-Triggered"},{"sourceId":"f1273349-fa3c-ca76-3df0-9855ef55ace9","sourcePort":"changed","targetId":"a309b344-64f1-650e-a834-6bf645c01071","targetPort":"show"}],"ports":[],"roots":["0c603aca-822b-0b02-384a-c81490efece0"]},{"name":"/#view/Chain of Custody View/coc Card View","nodes":[{"id":"45d1552b-cb20-dc00-9c8c-5607385ea529","type":"Group","parameters":{"sizeMode":"contentHeight","height":{"value":210,"unit":"px"},"flexWrap":"wrap","alignContent":"flex-start","alignX":"left","boxShadowEnabled":false,"boxShadowOffsetX":{"value":5,"unit":"px"},"boxShadowOffsetY":{"value":5,"unit":"px"},"paddingLeft":{"value":5,"unit":"px"},"paddingRight":{"value":5,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingBottom":{"value":5,"unit":"px"},"rowGap":{"value":0,"unit":"px"},"marginBottom":{"value":10,"unit":"px"},"boxShadowColor":"#29712454","borderRadius":{"value":5,"unit":"px"},"boxShadowBlurRadius":{"value":8,"unit":"px"},"marginRight":{"value":5,"unit":"px"},"boxShadowSpreadRadius":{"value":2,"unit":"px"},"borderStyle":"dashed","borderColor":"#b0b0b0"},"ports":[],"children":[{"id":"04e0a9a8-45d4-1057-cead-f5bd4ec2ec66","type":"Group","parameters":{"sizeMode":"contentHeight","alignX":"left","alignY":"top","flexDirection":"row"},"ports":[],"children":[{"id":"80883eb4-70ec-40b3-ee64-5958a51e4337","type":"Text","parameters":{"text":"Project No:","sizeMode":"contentSize","marginRight":{"value":5,"unit":"px"}},"ports":[],"children":[]},{"id":"e0f5434b-0fce-1808-7ec9-1cf43e7ef0d2","type":"Text","parameters":{"text":"-","fontFamily":"fonts/Roboto/Roboto-Bold.ttf","sizeMode":"contentHeight"},"ports":[],"children":[]}]},{"id":"9a5972c7-4f6e-3baf-f358-2b6a091a2408","type":"Group","parameters":{"sizeMode":"contentHeight","alignX":"left","alignY":"top","flexDirection":"row"},"ports":[],"children":[{"id":"7a36ecfa-394e-0baa-9a2d-11a38eb42ef2","type":"Text","parameters":{"text":"Client Name:","sizeMode":"contentSize","marginRight":{"value":5,"unit":"px"}},"ports":[],"children":[]},{"id":"1ec343ca-6ab9-8ce7-0c89-5e33fa7eb309","type":"Text","parameters":{"text":"Client Name","fontFamily":"fonts/Roboto/Roboto-Bold.ttf","sizeMode":"contentHeight"},"ports":[],"children":[]}]},{"id":"574f2ad1-458c-0743-0b3e-ba12faf80a8d","type":"Group","parameters":{"sizeMode":"contentHeight","alignX":"left","alignY":"top","flexDirection":"row"},"ports":[],"children":[{"id":"14a278f0-86cf-fd45-57a7-3038dfaea865","type":"Text","parameters":{"text":"Contact Name:","sizeMode":"contentSize","marginRight":{"value":5,"unit":"px"}},"ports":[],"children":[]},{"id":"dcd0b8c9-6dbe-eb40-9bc0-7663beb5a0f9","type":"Text","parameters":{"text":"Contact Name","fontFamily":"fonts/Roboto/Roboto-Bold.ttf","sizeMode":"contentHeight"},"ports":[],"children":[]}]},{"id":"5b5a32fe-6087-2d35-6d20-c02594b7c94e","type":"Group","parameters":{"sizeMode":"contentHeight","alignX":"left","alignY":"top","flexDirection":"row"},"ports":[],"children":[{"id":"90bf5eaa-5286-4ea9-020f-39e3fb90b2c9","type":"Text","parameters":{"text":"Phone:","sizeMode":"contentSize","marginRight":{"value":5,"unit":"px"}},"ports":[],"children":[]},{"id":"351d6d4a-1706-19f3-c3e9-0029e0857d4a","type":"Text","parameters":{"text":"Phone","fontFamily":"fonts/Roboto/Roboto-Bold.ttf","sizeMode":"contentHeight"},"ports":[],"children":[]}]},{"id":"22e073c5-b4ea-62be-50ef-ba3974e27d99","type":"Group","parameters":{"sizeMode":"contentHeight","alignX":"left","alignY":"top","flexDirection":"row"},"ports":[],"children":[{"id":"43f22fb9-3798-13fa-aee7-e8051cbb4a1e","type":"Text","parameters":{"text":"Address:","sizeMode":"contentSize","marginRight":{"value":5,"unit":"px"}},"ports":[],"children":[]},{"id":"480c65ee-4ac1-3543-212e-9ca0efa30df4","type":"Text","parameters":{"text":"","fontFamily":"fonts/Roboto/Roboto-Bold.ttf","sizeMode":"contentHeight"},"ports":[],"children":[]}]},{"id":"1931dd26-1809-d3a2-0a73-4f9de28d9842","type":"Group","parameters":{"sizeMode":"contentHeight","alignX":"left","alignY":"top","flexDirection":"row"},"ports":[],"children":[{"id":"cfef19cd-c61a-a47c-c68a-614ababc3541","type":"Text","parameters":{"text":"Total Sample:","sizeMode":"contentSize","marginRight":{"value":5,"unit":"px"}},"ports":[],"children":[]},{"id":"abd183ae-531a-b09f-0e15-7dc0d457feba","type":"Text","parameters":{"fontFamily":"fonts/Roboto/Roboto-Bold.ttf","sizeMode":"contentHeight","text":"-"},"ports":[],"children":[]}]},{"id":"42e6d896-b087-ff84-f946-eda4489b2ffb","type":"Group","parameters":{"sizeMode":"contentSize","alignX":"right","alignY":"bottom","flexDirection":"row","columnGap":{"value":10,"unit":"px"}},"ports":[],"children":[{"id":"67b8594a-a830-35b8-45a7-2aa88062305c","type":"net.noodl.controls.button","parameters":{"paddingLeft":{"value":0,"unit":"px"},"paddingRight":{"value":0,"unit":"px"},"alignY":"center","alignX":"center","sizeMode":"contentSize","useLabel":false,"useIcon":true,"iconIconSource":{"class":"material-icons","code":"arrow_right_alt","codeAsClass":false},"iconSpacing":{"value":0,"unit":"px"},"iconSize":{"value":30,"unit":"px"},"backgroundColor":"#5836F500","iconColor":"Primary ECC","minWidth":{"value":10,"unit":"px"}},"defaultStateTransitions":{},"ports":[],"children":[]}]}]},{"id":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","type":"Model2","parameters":{"idSource":"foreach","properties":"client_phone_text,client_contact_text,client_name_text,id_action,id_sa,id_text,address,project_number_text"},"ports":[],"children":[]},{"id":"703d7977-7c79-825e-5b45-3a0051ba416a","type":"JavaScriptFunction","parameters":{"functionScript":"\r\nconst supabase = Noodl.Variables.supabase;\r\n\r\nif (!supabase) throw new Error('Supabase client not found');\r\n\r\ntry {\r\n  const { data, error } = await supabase.from('samples_collected')\r\n                                        .select('count', { count: 'exact' })\r\n                                        .eq('inspection_request_id', Inputs.Ins)\r\n                                        .single();\r\n\r\n  if (error) {\r\n    console.error(error)\r\n    Outputs.Failure();\r\n  } else {\r\n    Outputs.Count = data.count;\r\n    console.log(data)\r\n    Outputs.Success();\r\n  }\r\n} catch (error) {\r\n    console.error(error)\r\n  Outputs.Failure();\r\n}\r\n"},"ports":[{"name":"in-Ins","displayName":"Ins","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":5},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Count","displayName":"Count","plug":"output","type":"*","group":"Outputs","index":7}],"children":[]},{"id":"a740cdad-5609-465f-7a96-6356155a75ac","type":"PageStackNavigateToPath","parameters":{"path":"/chain-of-custody","queryNames":"id"},"ports":[],"children":[]},{"id":"6a8618d9-2524-0ecf-7fca-4f784c22cc32","type":"JavaScriptFunction","parameters":{"functionScript":"if(!Inputs.Triggered) return;\r\nconst supabase = Noodl.Variables.supabase;\r\n\r\nif (!supabase) throw new Error('Supabase client not found');\r\nconst inspection = Inputs.INsp\r\n\r\ntry {\r\n  const { data, error } = await supabase\r\n                                .from('chain_of_custody')\r\n                                .select()\r\n                                .eq('inspection_id',inspection);\r\n\r\n  if (error) {\r\n    console.error(error)\r\n    Outputs.Failure();\r\n  } else {\r\n    console.log(data)\r\n    if(data.length > 0){\r\n        Outputs.Edit();\r\n    }\r\n    else {\r\n        Outputs.Add();\r\n    }\r\n  }\r\n} catch (error) {\r\n    console.error(error)\r\n  Outputs.Failure();\r\n}\r\n"},"ports":[{"name":"in-Triggered","displayName":"Triggered","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-INsp","displayName":"INsp","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Edit","displayName":"Edit","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-Add","displayName":"Add","plug":"output","type":"signal","group":"Outputs","index":8}],"children":[]},{"id":"e9127b5a-16af-94a3-413e-eff252b5f056","type":"PageStackNavigateToPath","parameters":{"path":"/edit-chain-of-custody","queryNames":"id"},"ports":[],"children":[]},{"id":"d1e79520-bb01-7ba2-d76e-64a24b5bbd97","type":"JavaScriptFunction","parameters":{"functionScript":"const inpt = Inputs.value;\r\ninpt === null ? Outputs.Value = (\"-\") : Outputs.Value = inpt"},"ports":[{"name":"in-value","displayName":"value","plug":"input","type":"*","group":"Inputs","index":4},{"name":"out-Value","displayName":"Value","plug":"output","type":"*","group":"Outputs","index":5}],"children":[]}],"connections":[{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-client_name_text","targetId":"1ec343ca-6ab9-8ce7-0c89-5e33fa7eb309","targetPort":"text"},{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-client_name_text","targetId":"dcd0b8c9-6dbe-eb40-9bc0-7663beb5a0f9","targetPort":"text"},{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-client_phone_text","targetId":"351d6d4a-1706-19f3-c3e9-0029e0857d4a","targetPort":"text"},{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-id_sa","targetId":"703d7977-7c79-825e-5b45-3a0051ba416a","targetPort":"in-Ins"},{"sourceId":"703d7977-7c79-825e-5b45-3a0051ba416a","sourcePort":"out-Count","targetId":"abd183ae-531a-b09f-0e15-7dc0d457feba","targetPort":"text"},{"sourceId":"6a8618d9-2524-0ecf-7fca-4f784c22cc32","sourcePort":"out-Add","targetId":"a740cdad-5609-465f-7a96-6356155a75ac","targetPort":"navigate"},{"sourceId":"6a8618d9-2524-0ecf-7fca-4f784c22cc32","sourcePort":"out-Edit","targetId":"e9127b5a-16af-94a3-413e-eff252b5f056","targetPort":"navigate"},{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-id_action","targetId":"6a8618d9-2524-0ecf-7fca-4f784c22cc32","targetPort":"in-INsp"},{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-id_action","targetId":"a740cdad-5609-465f-7a96-6356155a75ac","targetPort":"q-id"},{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-id_action","targetId":"e9127b5a-16af-94a3-413e-eff252b5f056","targetPort":"q-id"},{"sourceId":"67b8594a-a830-35b8-45a7-2aa88062305c","sourcePort":"onClick","targetId":"6a8618d9-2524-0ecf-7fca-4f784c22cc32","targetPort":"in-Triggered"},{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-address","targetId":"480c65ee-4ac1-3543-212e-9ca0efa30df4","targetPort":"text"},{"sourceId":"31eb9b6a-04e8-0681-fe0b-e7a88759a3a7","sourcePort":"prop-project_number_text","targetId":"d1e79520-bb01-7ba2-d76e-64a24b5bbd97","targetPort":"in-value"},{"sourceId":"d1e79520-bb01-7ba2-d76e-64a24b5bbd97","sourcePort":"out-Value","targetId":"e0f5434b-0fce-1808-7ec9-1cf43e7ef0d2","targetPort":"text"}],"ports":[],"roots":["45d1552b-cb20-dc00-9c8c-5607385ea529"]}]
[{"name":"/New Password","nodes":[{"id":"9b4293d0-140a-da5c-0758-7b9104b14154","type":"Page","parameters":{},"ports":[],"children":[{"id":"d62fb656-ba8e-2efc-ce5e-d98f23255b26","type":"Group","parameters":{},"ports":[],"children":[{"id":"9b526a96-f328-ceb9-dd45-455aeff549c3","type":"Group","parameters":{"sizeMode":"explicit","height":{"value":60,"unit":"px"},"backgroundColor":"Primary ECC","flexDirection":"row","justifyContent":"space-between"},"ports":[],"children":[{"id":"3e668e25-b008-3d8d-096e-75676b07ebc0","type":"Group","parameters":{"flexDirection":"row","sizeMode":"contentWidth"},"ports":[],"children":[{"id":"7f8f4987-1da6-88ca-68dc-258d2623a92f","type":"net.noodl.controls.button","parameters":{"alignY":"center","paddingRight":{"value":5,"unit":"px"},"paddingLeft":{"value":5,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingBottom":{"value":5,"unit":"px"},"backgroundColor":"transparent","minWidth":{"value":0,"unit":"px"},"useLabel":false,"useIcon":true,"iconIconSource":{"class":"material-icons","code":"arrow_back","codeAsClass":false},"iconSize":{"value":25,"unit":"px"},"marginLeft":{"value":5,"unit":"px"},"mounted":true},"ports":[],"children":[]},{"id":"9da00466-acb0-f4ad-a00c-cdaff230f2f5","type":"Text","parameters":{"sizeMode":"contentSize","position":"relative","alignY":"center","color":"White","fontFamily":"fonts/Roboto/Roboto-Bold.ttf","marginLeft":{"value":15,"unit":"px"},"text":"Set New Password"},"ports":[],"children":[]}]},{"id":"0b22c98d-0e1c-5a9f-748f-6a1cf114efb5","type":"Image","parameters":{"src":"ecclogo.png","sizeMode":"contentWidth","mixBlendMode":"screen","marginRight":{"value":5,"unit":"px"},"marginTop":{"value":5,"unit":"px"},"marginBottom":{"value":5,"unit":"px"}},"ports":[],"children":[]}]},{"id":"b1c0df47-07e4-afe8-de98-96ae64ea4b4e","type":"Group","parameters":{"paddingLeft":{"value":10,"unit":"px"},"paddingTop":{"value":10,"unit":"px"},"paddingRight":{"value":10,"unit":"px"},"alignX":"center","maxWidth":{"value":500,"unit":"px"}},"ports":[],"children":[{"id":"9e0dd371-902f-66dd-2f62-edc6c976c3cb","type":"Text","parameters":{"text":"Enter Your New Password","fontFamily":"fonts/Roboto/Roboto-Medium.ttf","color":"Grey - 800","fontSize":{"value":18,"unit":"px"},"sizeMode":"contentSize","alignX":"center"},"ports":[],"children":[]},{"id":"b861ead2-752f-e88a-f220-41b63a306687","type":"Text","parameters":{"text":"","fontFamily":"fonts/Roboto/Roboto-Medium.ttf","color":"Grey - 400","fontSize":{"value":16,"unit":"px"},"sizeMode":"contentSize","alignX":"center"},"ports":[],"children":[]},{"id":"9f4f82bd-9cd8-b31a-6877-50c8075a2efb","type":"net.noodl.controls.textinput","parameters":{"marginTop":{"value":10,"unit":"px"},"label":"Password","placeholder":"password here","fontSize":{"value":14,"unit":"px"},"type":"text"},"ports":[],"children":[]},{"id":"73657239-059e-ff65-30d4-a8e23a4c23e6","type":"Text","parameters":{"marginTop":{"value":0,"unit":"px"},"color":"#F64444","fontFamily":"fonts/Roboto/Roboto-Regular.ttf","fontSize":{"value":14,"unit":"px"}},"ports":[],"children":[]},{"id":"b1a98ce5-3c33-5905-b2b5-affaa95fd46a","type":"net.noodl.controls.button","parameters":{"marginTop":{"value":10,"unit":"px"},"alignX":"center","backgroundColor":"Primary ECC","label":"Update"},"ports":[],"children":[]}]}]}]},{"id":"277aef6a-44c6-9466-19b0-5aff49c2e8aa","type":"PageInputs","parameters":{},"ports":[],"children":[]},{"id":"946886e3-41d8-d283-e0d2-9dcb80e70f11","type":"Model2","parameters":{"modelId":"currentUser","properties":"email"},"ports":[],"children":[]},{"id":"e47a47e7-f3ac-fdc4-5d6e-5ea7244948e0","type":"String Format","parameters":{"format":"for {email}"},"ports":[],"children":[]},{"id":"45b21f3f-e6c2-9128-30c6-782f4a6e04c9","type":"JavaScriptFunction","parameters":{"functionScript":"if(!Inputs.Triggered)return;\r\nconst supabase = Noodl.Variables.supabase;\r\n\r\nif (!supabase) throw new Error('Supabase client not found');\r\n\r\nconst newPassword = Inputs.Password;\r\n\r\ntry {\r\n  const { data, error } = await supabase.auth.updateUser({\r\n    password: newPassword\r\n  });\r\n\r\n  if (error) {\r\n    console.error(error);\r\n    Outputs.Failure();\r\n    Outputs.Error = error\r\n  } else {\r\n    Outputs.UpdateUserResponse = data;\r\n    Outputs.Success();\r\n  }\r\n} catch (error) {\r\n  console.error(error);\r\n  Outputs.Failure();\r\n}\r\n"},"ports":[{"name":"in-Triggered","displayName":"Triggered","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-Password","displayName":"Password","plug":"input","type":"*","group":"Inputs","index":5},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":6},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-Error","displayName":"Error","plug":"output","type":"*","group":"Outputs","index":8},{"name":"out-UpdateUserResponse","displayName":"UpdateUserResponse","plug":"output","type":"*","group":"Outputs","index":9}],"children":[]},{"id":"38418668-1e09-be28-02c0-821c550feacc","type":"noodl.net.validate","parameters":{"Schema":"schema({\nPassword: string().min(6, 'must be at least 6 characters long'),\n})\n"},"ports":[],"children":[]},{"id":"c2f2eccb-af73-d86b-273f-96d66dc95f30","type":"Switch","parameters":{},"ports":[],"children":[]},{"id":"e8fe4f3c-cf08-c886-abaf-c839e2c3d8d2","type":"Condition","parameters":{},"ports":[],"children":[]},{"id":"dad3000f-31ac-ab94-ae37-63b6fdb68b9e","type":"/#Supabase Prefab/Supabase Prefab/User/Supabase - Log Out","parameters":{},"ports":[],"children":[]},{"id":"12862bfe-b9f6-a1a9-d02c-112b71e1975e","type":"RouterNavigate","parameters":{"router":"login","target":"/#view/Inspection Request View"},"ports":[],"children":[]},{"id":"99597c1f-b39e-2ef8-4bc8-9963a26f3fd5","type":"/#component/loading","parameters":{},"ports":[],"children":[]},{"id":"4f2c2891-2032-02f9-c072-794c1c9c1889","type":"/#component/Show Toast","parameters":{"Type":"Error"},"ports":[],"children":[]},{"id":"f9eee29e-15dd-2fa9-edf5-eb4ad60f2093","type":"JavaScriptFunction","parameters":{"functionScript":"if (!Inputs.trigger) return;\r\nconst supabase = Noodl.Variables.supabase;\r\nconst tableName = 'user_master';\r\nif (!Boolean(Noodl.Variables.supabase)) {\r\n  console.error(\"Supabase client is not configured !\")\r\n  return\r\n}\r\nconst id = Inputs.Id\r\n\r\nconst newRow = {\r\n  login_password: Inputs.login_password,\r\n};\r\nconsole.log(newRow);\r\n\r\ntry {\r\n  const { data, error } = await supabase\r\n                          .from(tableName)\r\n                          .update(newRow)\r\n                          .eq('login_email', id);\r\n  \r\n  if (error) {\r\n    throw new Error(error.message);\r\n  }\r\n  \r\n  Outputs.Success();\r\n  Outputs.Done = (\"Signup Success\");\r\n  console.log(data)\r\n} catch (error) {\r\n  Outputs.Error = error.message;\r\n  Outputs.Failure();\r\n}\r\n"},"ports":[{"name":"in-trigger","displayName":"trigger","plug":"input","type":"*","group":"Inputs","index":4},{"name":"in-Id","displayName":"Id","plug":"input","type":"*","group":"Inputs","index":5},{"name":"in-login_password","displayName":"login_password","plug":"input","type":"*","group":"Inputs","index":6},{"name":"out-Success","displayName":"Success","plug":"output","type":"signal","group":"Outputs","index":7},{"name":"out-Failure","displayName":"Failure","plug":"output","type":"signal","group":"Outputs","index":8},{"name":"out-Done","displayName":"Done","plug":"output","type":"*","group":"Outputs","index":9},{"name":"out-Error","displayName":"Error","plug":"output","type":"*","group":"Outputs","index":10}],"children":[]},{"id":"3c38753e-1dc1-b5a8-28dc-82d756f21987","type":"PageStackNavigateToPath","parameters":{"path":"/"},"ports":[],"children":[]},{"id":"9d295bce-8c63-5901-65e1-02fa59a9515f","type":"JavaScriptFunction","parameters":{"functionScript":"location.reload()"},"ports":[],"children":[]}],"connections":[{"sourceId":"946886e3-41d8-d283-e0d2-9dcb80e70f11","sourcePort":"prop-email","targetId":"e47a47e7-f3ac-fdc4-5d6e-5ea7244948e0","targetPort":"email"},{"sourceId":"e47a47e7-f3ac-fdc4-5d6e-5ea7244948e0","sourcePort":"formatted","targetId":"b861ead2-752f-e88a-f220-41b63a306687","targetPort":"text"},{"sourceId":"9f4f82bd-9cd8-b31a-6877-50c8075a2efb","sourcePort":"onTextChanged","targetId":"45b21f3f-e6c2-9128-30c6-782f4a6e04c9","targetPort":"in-Password"},{"sourceId":"38418668-1e09-be28-02c0-821c550feacc","sourcePort":"err-Password","targetId":"73657239-059e-ff65-30d4-a8e23a4c23e6","targetPort":"text"},{"sourceId":"9f4f82bd-9cd8-b31a-6877-50c8075a2efb","sourcePort":"onTextChanged","targetId":"38418668-1e09-be28-02c0-821c550feacc","targetPort":"prop-Password"},{"sourceId":"38418668-1e09-be28-02c0-821c550feacc","sourcePort":"haserr-Password","targetId":"73657239-059e-ff65-30d4-a8e23a4c23e6","targetPort":"mounted"},{"sourceId":"c2f2eccb-af73-d86b-273f-96d66dc95f30","sourcePort":"state","targetId":"38418668-1e09-be28-02c0-821c550feacc","targetPort":"Enabled"},{"sourceId":"b1a98ce5-3c33-5905-b2b5-affaa95fd46a","sourcePort":"onClick","targetId":"c2f2eccb-af73-d86b-273f-96d66dc95f30","targetPort":"on"},{"sourceId":"38418668-1e09-be28-02c0-821c550feacc","sourcePort":"IsValid","targetId":"e8fe4f3c-cf08-c886-abaf-c839e2c3d8d2","targetPort":"condition"},{"sourceId":"e8fe4f3c-cf08-c886-abaf-c839e2c3d8d2","sourcePort":"ontrue","targetId":"45b21f3f-e6c2-9128-30c6-782f4a6e04c9","targetPort":"in-Triggered"},{"sourceId":"b1a98ce5-3c33-5905-b2b5-affaa95fd46a","sourcePort":"onClick","targetId":"e8fe4f3c-cf08-c886-abaf-c839e2c3d8d2","targetPort":"eval"},{"sourceId":"7f8f4987-1da6-88ca-68dc-258d2623a92f","sourcePort":"onClick","targetId":"12862bfe-b9f6-a1a9-d02c-112b71e1975e","targetPort":"navigate"},{"sourceId":"e8fe4f3c-cf08-c886-abaf-c839e2c3d8d2","sourcePort":"ontrue","targetId":"99597c1f-b39e-2ef8-4bc8-9963a26f3fd5","targetPort":"show"},{"sourceId":"45b21f3f-e6c2-9128-30c6-782f4a6e04c9","sourcePort":"out-Failure","targetId":"99597c1f-b39e-2ef8-4bc8-9963a26f3fd5","targetPort":"close"},{"sourceId":"45b21f3f-e6c2-9128-30c6-782f4a6e04c9","sourcePort":"out-Error","targetId":"4f2c2891-2032-02f9-c072-794c1c9c1889","targetPort":"Message"},{"sourceId":"45b21f3f-e6c2-9128-30c6-782f4a6e04c9","sourcePort":"out-Failure","targetId":"4f2c2891-2032-02f9-c072-794c1c9c1889","targetPort":"Do"},{"sourceId":"dad3000f-31ac-ab94-ae37-63b6fdb68b9e","sourcePort":"Success","targetId":"99597c1f-b39e-2ef8-4bc8-9963a26f3fd5","targetPort":"close"},{"sourceId":"946886e3-41d8-d283-e0d2-9dcb80e70f11","sourcePort":"prop-email","targetId":"f9eee29e-15dd-2fa9-edf5-eb4ad60f2093","targetPort":"in-Id"},{"sourceId":"9f4f82bd-9cd8-b31a-6877-50c8075a2efb","sourcePort":"onTextChanged","targetId":"f9eee29e-15dd-2fa9-edf5-eb4ad60f2093","targetPort":"in-login_password"},{"sourceId":"45b21f3f-e6c2-9128-30c6-782f4a6e04c9","sourcePort":"out-Success","targetId":"f9eee29e-15dd-2fa9-edf5-eb4ad60f2093","targetPort":"in-trigger"},{"sourceId":"f9eee29e-15dd-2fa9-edf5-eb4ad60f2093","sourcePort":"out-Success","targetId":"dad3000f-31ac-ab94-ae37-63b6fdb68b9e","targetPort":"Do"},{"sourceId":"dad3000f-31ac-ab94-ae37-63b6fdb68b9e","sourcePort":"Success","targetId":"3c38753e-1dc1-b5a8-28dc-82d756f21987","targetPort":"navigate"},{"sourceId":"dad3000f-31ac-ab94-ae37-63b6fdb68b9e","sourcePort":"Success","targetId":"9d295bce-8c63-5901-65e1-02fa59a9515f","targetPort":"run"}],"ports":[],"roots":["9b4293d0-140a-da5c-0758-7b9104b14154"]}]